# Application Configuration
quarkus.application.name=fleet-ddd-system
quarkus.application.version=1.0.0
quarkus.http.port=8080

# ===============================
# Database Configuration
# ===============================
# TimescaleDB (PostgreSQL + time-series extension)
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=fleetuser
quarkus.datasource.password=fleetpass123
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/fleetdb
quarkus.datasource.reactive.url=postgresql://localhost:5432/fleetdb
quarkus.datasource.reactive.max-size=20

# Hibernate (minimal, since we're using event sourcing)
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=false

# Flyway Migrations
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
quarkus.flyway.locations=classpath:db/migration

# ===============================
# MQTT Configuration
# ===============================
# Incoming telemetry from tablets
mp.messaging.incoming.telemetry.connector=smallrye-mqtt
mp.messaging.incoming.telemetry.host=localhost
mp.messaging.incoming.telemetry.port=1883
mp.messaging.incoming.telemetry.username=backend
mp.messaging.incoming.telemetry.password=backend123
mp.messaging.incoming.telemetry.topic=fleet/+/bms/telemetry
mp.messaging.incoming.telemetry.qos=1
mp.messaging.incoming.telemetry.broadcast=true

# Outgoing domain events (integration events)
mp.messaging.outgoing.domain-events.connector=smallrye-mqtt
mp.messaging.outgoing.domain-events.host=localhost
mp.messaging.outgoing.domain-events.port=1883
mp.messaging.outgoing.domain-events.username=backend
mp.messaging.outgoing.domain-events.password=backend123
mp.messaging.outgoing.domain-events.topic=fleet/events
mp.messaging.outgoing.domain-events.qos=1

# ===============================
# Redis (Saga State Management)
# ===============================
quarkus.redis.hosts=redis://localhost:6379
quarkus.redis.timeout=10s

# ===============================
# CORS (for dashboard)
# ===============================
quarkus.http.cors=true
quarkus.http.cors.origins=*
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,content-type,authorization

# ===============================
# Health & Metrics
# ===============================
quarkus.smallrye-health.root-path=/health
quarkus.smallrye-health.liveness-path=/health/live
quarkus.smallrye-health.readiness-path=/health/ready

quarkus.micrometer.export.prometheus.path=/metrics
quarkus.micrometer.binder.http-server.enabled=true
quarkus.micrometer.binder.http-client.enabled=true

# ===============================
# Logging
# ===============================
quarkus.log.level=INFO
quarkus.log.console.enable=true
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Domain logging
quarkus.log.category."com.fleet.domain".level=DEBUG
quarkus.log.category."com.fleet.application".level=DEBUG
quarkus.log.category."com.fleet.infrastructure".level=INFO

# SQL logging (for debugging)
quarkus.log.category."io.quarkus.hibernate.orm".level=INFO

# ===============================
# Development Mode Settings
# ===============================
%dev.quarkus.log.level=DEBUG
%dev.quarkus.hibernate-orm.log.sql=true
%dev.quarkus.http.cors.origins=http://localhost:3000,http://localhost:8080

# ===============================
# Production Mode Settings
# ===============================
%prod.quarkus.log.level=INFO
%prod.quarkus.hibernate-orm.log.sql=false
%prod.quarkus.http.cors.origins=https://your-production-domain.com

# ===============================
# Event Sourcing Configuration
# ===============================
# Event store batch size for reconstruction
event-sourcing.batch-size=100
event-sourcing.snapshot-frequency=100
event-sourcing.enable-snapshots=true

# ===============================
# Saga Configuration
# ===============================
saga.timeout-minutes=60
saga.retry-max-attempts=3
saga.retry-backoff-seconds=5
